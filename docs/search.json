[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "about",
    "section": "",
    "text": "About me!"
  },
  {
    "objectID": "parfumo.html",
    "href": "parfumo.html",
    "title": "parfumo",
    "section": "",
    "text": "Today is Thursday, December 12th and I’m working on this weeks’ tidy tuesday dataset sourced from Parfumo.\nMy goals for today are to continue to practise using dplyr::across and dplyr::map functions, and to create some visualizations using packages I’ve not used before!\n\n\nCode\nlibrary(dplyr)\nlibrary(tidyr)\n\n\n\n\nCode\n# Option 1: tidytuesdayR package \n## install.packages(\"tidytuesdayR\")\n# tuesdata &lt;- tidytuesdayR::tt_load('2024-12-10')\n# ## OR\ntuesdata &lt;- tidytuesdayR::tt_load(2024, week = 50)\n\nparfumo_data_clean &lt;- tuesdata$parfumo_data_clean\n\n# Option 2: Read directly from GitHub\n# \n# parfumo_data_clean &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-12-10/parfumo_data_clean.csv')\n\n\n\n\nData exploration\n\n\nCode\nskimr::skim(parfumo_data_clean)\n\n\n\nData summary\n\n\nName\nparfumo_data_clean\n\n\nNumber of rows\n59325\n\n\nNumber of columns\n13\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n10\n\n\nnumeric\n3\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\nNumber\n57905\n0.02\n1\n5\n0\n362\n0\n\n\nName\n1\n1.00\n1\n120\n0\n55119\n0\n\n\nBrand\n1\n1.00\n2\n52\n0\n1451\n0\n\n\nConcentration\n46842\n0.21\n5\n40\n0\n412\n0\n\n\nMain_Accords\n27100\n0.54\n5\n48\n0\n19159\n0\n\n\nTop_Notes\n28186\n0.52\n3\n281\n0\n21743\n0\n\n\nMiddle_Notes\n28176\n0.53\n3\n407\n0\n22050\n0\n\n\nBase_Notes\n28171\n0.53\n3\n337\n0\n18023\n0\n\n\nPerfumers\n38781\n0.35\n4\n111\n0\n2448\n0\n\n\nURL\n0\n1.00\n3\n146\n0\n59281\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nRelease_Year\n20316\n0.66\n2006.26\n22.88\n1709\n2005.0\n2013.0\n2018.0\n2024\n▁▁▁▁▇\n\n\nRating_Value\n29279\n0.51\n7.35\n0.93\n0\n6.9\n7.4\n7.9\n10\n▁▁▁▇▂\n\n\nRating_Count\n29279\n0.51\n60.65\n118.19\n2\n6.0\n19.0\n62.0\n2732\n▇▁▁▁▁\n\n\n\n\n\nImmediately we can see that quite a large number of perfumes have missing information, such as concentration, the notes, and perfumers. We can look to see if the missingness is correlated across variables. We can plot this using a correlation matrix.\n\n\nCode\nparfumo_missing &lt;- parfumo_data_clean %&gt;%\n  mutate(across(Concentration:Perfumers, ~ !is.na(.), .names = \"{.col}_missing\"))\n\nmissing_cor_df &lt;- cor(parfumo_missing |&gt; select(contains('Missing')))\nrange(missing_cor_df)\n\n\n[1] 0.01594804 1.00000000\n\n\nCorrelation ranges from 0.0159 to 1, no negative correlations.\n\n\nCode\n#install.packages('ggcorrplot')\nlibrary(ggcorrplot)\nggcorrplot::ggcorrplot(missing_cor_df, type = 'lower', colors = c('white', 'pink', 'red'))\n\n\n\n\n\nThe good news is that it looks like if any of the notes are missing, the the other notes are missing as well. The rating count and rating value are also highly correlated, which is unsurprising as well.\n\n\nCode\n#Since there are a lot of text for the main accords, we'll have to make it long format when we split up the main accords.\n#if we're only looking at accords, we can make it into a long dataframe\naccords_vec &lt;- parfumo_data_clean |&gt; filter(!is.na(Rating_Value)) |&gt; \n  mutate(accords = strsplit(as.character(Main_Accords), split = \", \")) |&gt; \n  tidyr::unnest(accords)\n\n\nThe prompts today are:\n1. What factors most influence the rating of a perfume?\n2. Are there distinct scent families that dominate the market, and how are they perceived by users?\n3. Has the popularity of certain fragrance notes evolved over time?\n\n\nCode\n#If I want to have a plot of the range of values and accords\nggplot(data = accords_vec, aes(x = Rating_Value, y = accords, fill = accords)) + geom_boxplot() + theme_bw() + labs(x = 'Rating Value', y = 'Accords', title = 'Distribution of Ratings Across Accords')"
  },
  {
    "objectID": "border_crossing.html",
    "href": "border_crossing.html",
    "title": "Border Census",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\nlibrary(janitor)\n\n\n\n\nCode\ncbp_resp &lt;- bind_rows(\n  read_csv(\"https://www.cbp.gov/sites/default/files/assets/documents/2023-Nov/nationwide-encounters-fy20-fy23-aor.csv\"),\n  read_csv(\"https://www.cbp.gov/sites/default/files/2024-10/nationwide-encounters-fy21-fy24-aor.csv\")\n) |&gt;\n  janitor::clean_names() |&gt;\n  unique()\n\ncbp_state &lt;- bind_rows(\n  read_csv(\"https://www.cbp.gov/sites/default/files/assets/documents/2023-Nov/nationwide-encounters-fy20-fy23-state.csv\"),\n  read_csv(\"https://www.cbp.gov/sites/default/files/2024-10/nationwide-encounters-fy21-fy24-state.csv\")\n) |&gt;\n  janitor::clean_names() |&gt;\n  unique()\n\n\n\n\nCode\nskimr::skim(cbp_resp)\n\n\n\nData summary\n\n\nName\ncbp_resp\n\n\nNumber of rows\n68815\n\n\nNumber of columns\n12\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n10\n\n\nnumeric\n2\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\nmonth_grouping\n0\n1\n4\n4\n0\n1\n0\n\n\nmonth_abbv\n0\n1\n3\n3\n0\n12\n0\n\n\ncomponent\n0\n1\n18\n26\n0\n2\n0\n\n\nland_border_region\n0\n1\n5\n21\n0\n3\n0\n\n\narea_of_responsibility\n0\n1\n11\n26\n0\n41\n0\n\n\naor_abbv\n0\n1\n3\n13\n0\n41\n0\n\n\ndemographic\n0\n1\n4\n18\n0\n4\n0\n\n\ncitizenship\n0\n1\n4\n26\n0\n22\n0\n\n\ntitle_of_authority\n0\n1\n7\n8\n0\n2\n0\n\n\nencounter_type\n0\n1\n10\n13\n0\n3\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nfiscal_year\n0\n1\n2022.20\n1.35\n2020\n2021\n2022\n2023\n2024\n▅▆▇▇▇\n\n\nencounter_count\n0\n1\n166.71\n727.46\n0\n2\n9\n57\n25457\n▇▁▁▁▁\n\n\n\n\n\nCode\nskimr::skim(cbp_state)\n\n\n\nData summary\n\n\nName\ncbp_state\n\n\nNumber of rows\n54939\n\n\nNumber of columns\n9\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n7\n\n\nnumeric\n2\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\nmonth_grouping\n0\n1\n4\n4\n0\n1\n0\n\n\nmonth_abbv\n0\n1\n3\n3\n0\n12\n0\n\n\nland_border_region\n0\n1\n5\n21\n0\n3\n0\n\n\nstate\n0\n1\n2\n2\n0\n48\n0\n\n\ndemographic\n0\n1\n4\n18\n0\n4\n0\n\n\ncitizenship\n0\n1\n4\n26\n0\n22\n0\n\n\ntitle_of_authority\n0\n1\n7\n8\n0\n2\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nfiscal_year\n0\n1\n2022.23\n1.36\n2020\n2021\n2022\n2023\n2024\n▅▆▇▇▇\n\n\nencounter_count\n0\n1\n208.82\n1090.00\n0\n2\n9\n46\n36802\n▇▁▁▁▁\n\n\n\n\n\nLet’s start with just looking at the number of border crossings across time by land border region\n\n\nCode\nlibrary(ggplot2)\n\nggplot(cbp_state, aes(x = month_abbv, y = encounter_count, fill = land_border_region)) +\n  geom_histogram(stat = 'identity') + \n  theme_bw() + \n  facet_grid(.~ fiscal_year) + \n  labs(x = 'Time', y = 'Count', title = 'Number of Border Crossings Across FY2020 - FY2024 by Land Border Region') + \n  scale_y_continuous(labels = scales::unit_format(unit = \"K\", scale = 1e-4))\n\n\n\n\n\nIf we wanted to plot the number of encounters on a map by state, how would we do that?\n\n\nCode\n# library(tidycensus)\n# \n# #getting tidycensus data\n# geography_df &lt;- get_acs(\n#   variables = \"B19013_001\",\n#   geography = \"state\",\n#   geometry = TRUE,\n#   year = 2020\n# )\n# \n# geography_df$state_abbr &lt;- state.abb[match(geography_df$NAME, state.name)]\n# \n# #add the geography information to the cbp_state data\n# \n# cbp_state$geometry &lt;- geography_df$geometry[match(cbp_state$state, geography_df$state_abbr)]\n# \n# #Now we can generate the plot\n# \n# cbp_grouped &lt;-  cbp_state |&gt; group_by(fiscal_year, geometry) |&gt; summarize(total = sum(encounter_count)) |&gt; sf::st_sf()\n# \n# ggplot(cbp_grouped, aes(fill = total)) +\n#   geom_sf(color = NA) +\n#   facet_wrap(~fiscal_year)\n\n\nPretty ugly but at least we got somewhere as a starting point.\nNow maybe let’s work on the prompts…\nPrompts from Tidy Tuesday:\n1. How has the implementation (and potential end) of Title 42 affected migration and enforcement trends compared to Title 8 actions?\nIf we look at things from the state level…\n\n\nCode\nggplot(cbp_state |&gt; mutate(Date = lubridate::ym(paste(fiscal_year, month_abbv))) |&gt; \n         group_by(Date, title_of_authority, land_border_region) |&gt; \n         summarize(total = sum(encounter_count)),  \n         aes(x = Date, y = total, color = title_of_authority, shape = land_border_region)) +\n  geom_point(stat = 'identity') + \n  geom_line() + \n  theme_bw() + \n  facet_wrap(~ land_border_region) + \n  labs(x = 'Time', y = 'Count', title = 'Number of Border Crossings Across FY2020 - FY2024 by Land Border Region') + \n  scale_y_continuous(labels = scales::unit_format(unit = \"K\", scale = 1e-4))\n\n\n\n\n\nit looks like there are some yo-yo and reactionary trends, it could be related to court decisions. Almost entirely restricted to the Southwest Land Border.\nIf we look at people with the same citizenship trying to cross at the north vs south borders, what would that look like?\n\n\nCode\nggplot(cbp_state |&gt; \n         filter(citizenship %in% c(\"INDIA\", \"CHINA, PEOPLES REPUBLIC OF\", \"OTHER\")) |&gt; \n         mutate(Date = lubridate::ym(paste(fiscal_year, month_abbv))) |&gt; \n         group_by(Date, title_of_authority, land_border_region, citizenship) |&gt; \n         summarize(total = sum(encounter_count)),  \n         aes(x = Date, y = total, color = title_of_authority, shape = land_border_region)) +\n  geom_point(stat = 'identity') + \n  geom_line() + \n  theme_bw() + \n  facet_wrap(citizenship ~ land_border_region) + \n  labs(x = 'Time', y = 'Count', title = 'Number of Border Crossings Across FY2020 - FY2024 by Land Border Region') + \n  scale_y_continuous(labels = scales::unit_format(unit = \"K\", scale = 1e-4))\n\n\n\n\n\nCode\nggplot(cbp_state |&gt; \n         filter(citizenship %in% c(\"MEXICO\", \"VENEZUELA\", \"GUATEMALA\", \"HAITI\")) |&gt; \n         mutate(Date = lubridate::ym(paste(fiscal_year, month_abbv))) |&gt; \n         group_by(Date, title_of_authority, land_border_region, citizenship) |&gt; \n         summarize(total = sum(encounter_count)),  \n         aes(x = Date, y = total, color = title_of_authority, shape = land_border_region)) +\n  geom_point(stat = 'identity') + \n  geom_line() + \n  theme_bw() + \n  facet_wrap(citizenship ~ land_border_region) + \n  labs(x = 'Time', y = 'Count', title = 'Number of Border Crossings Across FY2020 - FY2024 by Land Border Region') + \n  scale_y_continuous(labels = scales::unit_format(unit = \"K\", scale = 1e-4))\n\n\n\n\n\nWhile we see Mexico with overwhelmingly the number of denied border crossings, the pattern exhibited for Mexico is unlike the pattern for any other country, at any other land border.\n\n\nCode\nggplot(cbp_state |&gt; \n         filter(citizenship %in% c(\"MEXICO\") & land_border_region == 'Southwest Land Border') |&gt; \n         mutate(Date = lubridate::ym(paste(fiscal_year, month_abbv))) |&gt; \n         group_by(Date, title_of_authority, demographic) |&gt; \n         summarize(total = sum(encounter_count)),  \n         aes(x = Date, y = total, color = title_of_authority)) +\n  geom_point(stat = 'identity') + \n  geom_line() + \n  theme_bw() + \n  facet_wrap(~demographic) + \n  labs(x = 'Time', y = 'Count', title = 'Number of Border Crossings Across FY2020 - FY2024 by Land Border Region') + \n  scale_y_continuous(labels = scales::unit_format(unit = \"K\", scale = 1e-4))"
  }
]